<div class="w-[350px] aspect-square relative">
  <div class="inset-0 absolute grid place-content-center">
    <circular-progress-bar
      #boqSubItemsProgressRef
      [value]="boqSubItemsPercentageProgress"
      [color]="colors.accent.main"
      [backgroundColor]="'#D7D7D7'"
      [showValue]="false"
      [valueStyle]="'font-size:40px'"
      [text]="''"
      class="-mt-2"
      [style]="'width:300px'"
    ></circular-progress-bar>
  </div>
  <div class="inset-0 absolute grid place-content-center">
    <circular-progress-bar
      #boqItemsProgressRef
      [value]="boqItemsPercentageProgress"
      [color]="'#000000'"
      [backgroundColor]="'#D7D7D7'"
      [showValue]="false"
      [thickness]="'96%'"
      [valueStyle]="'font-size:40px'"
      [text]="''"
      class="-mt-2"
      [style]="'width:220px'"
    ></circular-progress-bar>
  </div>
  <!-- <div class="inset-0 absolute grid place-content-center">
  <svg class="w-80 h-80 animate-spin" viewBox="0 0 800 800">
    <circle
      cx="400"
      cy="400"
      r="310"
      fill="none"
      stroke="black"
      stroke-width="10"
      stroke-linecap="round"
      stroke-dasharray="2000"
      stroke-dashoffset="500"
    ></circle>
  </svg>
</div> -->
<div class="inset-0 absolute grid place-content-center text-center">
  <div class="space-y-2">
    <div class="space-y-1">
      <div
          [class]="
            'text-2xl  text-black transition-all duration-300 ' +
            (boqItemsPercentageProgress >= 100 ? 'font-extrabold' : 'font-bold')
          "
        >
        <animated-digit
            [digit]="
              boqItemsPercentageProgress - prevBOQItemsPercentageProgress
            "
          [fromDigit]="prevBOQItemsPercentageProgress"
          [duration]="500"
          ></animated-digit
          >%
        </div>
        <div
          [class]="
            ' transition-all duration-300 ' +
            (boqItemsPercentageProgress >= 100
              ? ' text-black '
              : 'text-gray ') +
            (boqItemsIsFetching ? ' font-bold' : 'text-normal')
          "
          >
          Loading BOQs
        </div>
      </div>
      <div class="space-y-1">
        <div
          [class]="
            ' text-2xl transition-all text-accent duration-300 ' +
            (boqItemsPercentageProgress >= 100
              ? ' font-extrabold'
              : 'font-bold')
          "
          >
          <animated-digit
            [digit]="
              boqSubItemsPercentageProgress - prevBOQSubItemsPercentageProgress
            "
            [fromDigit]="prevBOQSubItemsPercentageProgress"
            [duration]="500"
            ></animated-digit
            >%
          </div>
          <div
          [class]="
            ' transition-all duration-300 ' +
            (boqSubItemsPercentageProgress >= 100
              ? 'text-accent'
              : 'text-gray') +
            (boqSubItemsIsFetching ? ' font-bold ' : 'text-normal')
          "
            >
            Loading Sub Items
          </div>
        </div>
      </div>
    </div>
  </div>
  @if (failed_at) {
    <div class="flex justify-center space-y-2">
      <div class="text-center space-y-2">
        <div class="text-red">Failed to load BOQ, please retry</div>
        <button (click)="retry()" class="mt-3" mat-stroked-button>
          <mat-icon inline>refresh</mat-icon>
          Retry
        </button>
      </div>
    </div>
  }
